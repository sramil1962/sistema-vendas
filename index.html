<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Perfumes & Produtos</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: Arial, sans-serif;
            background: linear-gradient(135deg, #0f0f1e, #1a1a3e);
            color: white;
            padding: 20px;
            min-height: 100vh;
        }
        .container { max-width: 1200px; margin: 0 auto; }
        h1 {
            color: #d4af37;
            text-align: center;
            margin-bottom: 30px;
            font-size: 2.5em;
        }
        .status-bar {
            background: #16213e;
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border: 1px solid #2a2a3e;
        }
        .btn {
            background: #d4af37;
            color: #1a1a2e;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            font-weight: bold;
            transition: 0.3s;
        }
        .btn:hover { background: #b8941f; }
        .btn-danger { background: #dc3545; color: white; }
        .btn-danger:hover { background: #c82333; }
        .card {
            background: #16213e;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 20px;
            border: 1px solid #2a2a3e;
        }
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }
        .stat-card {
            background: #0f0f1e;
            padding: 15px;
            border-radius: 8px;
            border-left: 4px solid #d4af37;
        }
        .stat-label { color: #a0a0b0; font-size: 0.9em; }
        .stat-value {
            font-size: 1.8em;
            font-weight: bold;
            color: #d4af37;
        }
        input, select {
            width: 100%;
            padding: 10px;
            margin: 5px 0 15px 0;
            background: #0f0f1e;
            border: 1px solid #2a2a3e;
            border-radius: 5px;
            color: white;
        }
        table {
            width: 100%;
            border-collapse: collapse;
        }
        th, td {
            padding: 10px;
            text-align: left;
            border-bottom: 1px solid #2a2a3e;
        }
        th { color: #d4af37; }
        .tab-buttons {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }
        .tab-btn {
            padding: 10px 20px;
            background: #16213e;
            border: 1px solid #2a2a3e;
            color: white;
            cursor: pointer;
            border-radius: 5px;
            flex: 1;
            min-width: 100px;
        }
        .tab-btn.active {
            background: #d4af37;
            color: #1a1a2e;
            border-color: #d4af37;
        }
        .tab-content { display: none; }
        .tab-content.active { display: block; }
        @media (max-width: 768px) {
            .tab-buttons { flex-direction: column; }
            .stats-grid { grid-template-columns: 1fr; }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üíé Perfumes & Produtos</h1>
        
        <div class="status-bar">
            <div>
                <span>Status: </span>
                <span id="statusNuvem">üíæ Local</span>
            </div>
            <div>
                <span>Vendedor: </span>
                <select id="vendedorSelect">
                    <option value="Voc√™">Voc√™</option>
                    <option value="Esposa">Esposa</option>
                    <option value="Filha">Filha</option>
                </select>
                <button class="btn" onclick="ativarNuvem()" id="btnNuvem">‚òÅÔ∏è Ativar Nuvem</button>
            </div>
        </div>

        <div class="stats-grid">
            <div class="stat-card">
                <div class="stat-label">Produtos</div>
                <div class="stat-value" id="totalProdutos">0</div>
            </div>
            <div class="stat-card">
                <div class="stat-label">Estoque</div>
                <div class="stat-value" id="totalEstoque">0</div>
            </div>
            <div class="stat-card">
                <div class="stat-label">Vendas Hoje</div>
                <div class="stat-value" id="vendasHoje">R$ 0</div>
            </div>
            <div class="stat-card">
                <div class="stat-label">A Receber</div>
                <div class="stat-value" id="contasReceber">R$ 0</div>
            </div>
        </div>

        <div class="tab-buttons">
            <button class="tab-btn active" onclick="mudarAba('produtos')">üì¶ Produtos</button>
            <button class="tab-btn" onclick="mudarAba('vendas')">üí∞ Vendas</button>
            <button class="tab-btn" onclick="mudarAba('clientes')">üë• Clientes</button>
        </div>

        <div id="produtos" class="tab-content active">
            <div class="card">
                <h3>‚ûï Adicionar Produto</h3>
                <form id="formProduto" onsubmit="adicionarProduto(event)">
                    <input type="text" id="nomeProduto" placeholder="Nome do produto" required>
                    <select id="categoriaProduto">
                        <option>Perfumes</option><option>Cosm√©ticos</option><option>Eletr√¥nicos</option><option>Roupas</option><option>Outros</option>
                    </select>
                    <input type="number" id="precoCusto" placeholder="Pre√ßo de custo" step="0.01" required>
                    <input type="number" id="precoVenda" placeholder="Pre√ßo de venda" step="0.01" required>
                    <input type="number" id="quantidadeEstoque" placeholder="Quantidade" required>
                    <button type="submit" class="btn">Adicionar Produto</button>
                </form>
            </div>

            <div class="card">
                <h3>üìã Lista de Produtos</h3>
                <table>
                    <thead>
                        <tr>
                            <th>Produto</th><th>Categoria</th><th>Custo</th><th>Venda</th><th>Estoque</th><th>A√ß√µes</th>
                        </tr>
                    </thead>
                    <tbody id="listaProdutos"></tbody>
                </table>
            </div>
        </div>

        <div id="vendas" class="tab-content">
            <div class="card">
                <h3>üí∞ Registrar Venda</h3>
                <p>Funcionalidade em desenvolvimento...</p>
            </div>
        </div>

        <div id="clientes" class="tab-content">
            <div class="card">
                <h3>üë• Clientes</h3>
                <p>Funcionalidade em desenvolvimento...</p>
            </div>
        </div>
    </div>

    <script>
        // ==========================================
        // SISTEMA DE VENDAS - VERS√ÉO SIMPLES E FUNCIONAL
        // ==========================================
        
        // Configura√ß√£o do Firebase (caso queira ativar)
        const firebaseConfig = {
            apiKey: "AIzaSyAhj8TXnxMGv0YpzCS1vFgHHQe6vkzGod",
            authDomain: "sistema-vendas-perfumes.firebaseapp.com",
            databaseURL: "https://sistema-vendas-perfumes-default-rtdb.firebaseio.com",
            projectId: "sistema-vendas-perfumes",
            storageBucket: "sistema-vendas-perfumes.appspot.com",
            messagingSenderId: "361311945051",
            appId: "1:361311945051:web:bcbf5acba4b89c5b781a7e"
        };

        // Estado Global
        let produtos = [];
        let clientes = [];
        let vendas = [];
        let usandoNuvem = false;

        // ==========================================
        // FUN√á√ïES DE CARREGAMENTO
        // ==========================================
        
        function carregarDados() {
            console.log('üîç Carregando dados...');
            
            // Tentar ler do localStorage com v√°rias chaves poss√≠veis
            const chavesPossiveis = [
                'perfumes_produtos',
                'produtos',
                'sistema_vendas_produtos'
            ];
            
            for (let chave of chavesPossiveis) {
                try {
                    const dados = localStorage.getItem(chave);
                    if (dados) {
                        produtos = JSON.parse(dados);
                        console.log(`‚úÖ Encontrados ${produtos.length} produtos na chave: ${chave}`);
                        break;
                    }
                } catch (e) {}
            }
            
            // Se n√£o encontrou nada, criar dados de exemplo
            if (produtos.length === 0) {
                console.log('üì¶ Nenhum produto encontrado, criando exemplo...');
                produtos = [
                    { id: 1, nome: 'Perfume Importado', categoria: 'Perfumes', precoCusto: 80, precoVenda: 150, quantidade: 10 },
                    { id: 2, nome: 'Hidratante Corporal', categoria: 'Cosm√©ticos', precoCusto: 25, precoVenda: 50, quantidade: 15 },
                ];
                localStorage.setItem('perfumes_produtos', JSON.stringify(produtos));
            }
            
            // Atualizar interface
            atualizarInterface();
        }

        // ==========================================
        // FUN√á√ïES DE PRODUTOS
        // ==========================================
        
        function adicionarProduto(event) {
            event.preventDefault();
            
            const novoProduto = {
                id: Date.now(),
                nome: document.getElementById('nomeProduto').value,
                categoria: document.getElementById('categoriaProduto').value,
                precoCusto: parseFloat(document.getElementById('precoCusto').value),
                precoVenda: parseFloat(document.getElementById('precoVenda').value),
                quantidade: parseInt(document.getElementById('quantidadeEstoque').value)
            };
            
            produtos.push(novoProduto);
            salvarDados();
            atualizarInterface();
            event.target.reset();
            
            alert('‚úÖ Produto adicionado!');
        }

        function removerProduto(id) {
            if (confirm('Tem certeza que deseja remover este produto?')) {
                produtos = produtos.filter(p => p.id !== id);
                salvarDados();
                atualizarInterface();
            }
        }

        // ==========================================
        // FUN√á√ïES DE SALVAMENTO
        // ==========================================
        
        function salvarDados() {
            // Salvar localmente
            localStorage.setItem('perfumes_produtos', JSON.stringify(produtos));
            console.log('üíæ Dados salvos localmente');
            
            // Se estiver usando nuvem, tentar salvar l√° tamb√©m
            if (usandoNuvem && typeof firebase !== 'undefined' && window.db) {
                try {
                    window.db.ref('/produtos').set(produtos);
                } catch (e) {
                    console.log('Erro ao salvar na nuvem');
                }
            }
        }

        // ==========================================
        // FUN√á√ïES DE INTERFACE
        // ==========================================
        
        function atualizarInterface() {
            // Atualizar lista de produtos
            let html = '';
            let totalEstoque = 0;
            
            produtos.forEach(p => {
                html += `
                    <tr>
                        <td>${p.nome}</td>
                        <td>${p.categoria}</td>
                        <td>R$ ${p.precoCusto.toFixed(2)}</td>
                        <td>R$ ${p.precoVenda.toFixed(2)}</td>
                        <td>${p.quantidade}</td>
                        <td>
                            <button class="btn btn-danger" onclick="removerProduto(${p.id})">üóëÔ∏è</button>
                        </td>
                    </tr>
                `;
                totalEstoque += p.quantidade;
            });
            
            document.getElementById('listaProdutos').innerHTML = html || '<tr><td colspan="6">Nenhum produto cadastrado</td></tr>';
            document.getElementById('totalProdutos').textContent = produtos.length;
            document.getElementById('totalEstoque').textContent = totalEstoque;
            
            // Atualizar status da nuvem
            document.getElementById('statusNuvem').innerHTML = usandoNuvem ? '‚òÅÔ∏è Nuvem' : 'üíæ Local';
        }

        function mudarAba(aba) {
            document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
            document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
            document.querySelector(`[onclick="mudarAba('${aba}')"]`).classList.add('active');
            document.getElementById(aba).classList.add('active');
        }

        function selectVendedor() {
            const vendedor = document.getElementById('vendedorSelect').value;
            console.log('Vendedor selecionado:', vendedor);
        }

        // ==========================================
        // FUN√á√ïES DA NUVEM
        // ==========================================
        
        function ativarNuvem() {
            if (usandoNuvem) {
                usandoNuvem = false;
                localStorage.removeItem('usarNuvem');
                document.getElementById('btnNuvem').innerHTML = '‚òÅÔ∏è Ativar Nuvem';
                document.getElementById('statusNuvem').innerHTML = 'üíæ Local';
                alert('üîå Modo local ativado');
                return;
            }
            
            // Tentar carregar Firebase
            if (typeof firebase === 'undefined') {
                // Carregar Firebase dinamicamente
                const script1 = document.createElement('script');
                script1.src = 'https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js';
                document.head.appendChild(script1);
                
                const script2 = document.createElement('script');
                script2.src = 'https://www.gstatic.com/firebasejs/9.22.0/firebase-database-compat.js';
                document.head.appendChild(script2);
                
                script2.onload = function() {
                    firebase.initializeApp(firebaseConfig);
                    window.db = firebase.database();
                    console.log('‚úÖ Firebase carregado');
                    ativarModoNuvem();
                };
            } else {
                ativarModoNuvem();
            }
        }
        
        function ativarModoNuvem() {
            usandoNuvem = true;
            localStorage.setItem('usarNuvem', 'true');
            document.getElementById('btnNuvem').innerHTML = 'üíæ Desativar Nuvem';
            document.getElementById('statusNuvem').innerHTML = '‚òÅÔ∏è Nuvem';
            
            // Tentar buscar dados da nuvem
            window.db.ref('/produtos').once('value')
                .then(snap => {
                    const dados = snap.val();
                    if (dados && dados.length > 0) {
                        produtos = dados;
                        salvarDados();
                        atualizarInterface();
                        alert(`‚úÖ ${produtos.length} produtos carregados da nuvem!`);
                    } else {
                        // Se n√£o tiver dados na nuvem, enviar os locais
                        window.db.ref('/produtos').set(produtos);
                        alert(`‚òÅÔ∏è ${produtos.length} produtos enviados para nuvem!`);
                    }
                })
                .catch(err => {
                    console.log('Erro ao acessar nuvem:', err);
                    alert('‚ùå Erro ao conectar com nuvem');
                    usandoNuvem = false;
                    localStorage.removeItem('usarNuvem');
                    document.getElementById('btnNuvem').innerHTML = '‚òÅÔ∏è Ativar Nuvem';
                    document.getElementById('statusNuvem').innerHTML = 'üíæ Local';
                });
        }

        // ==========================================
        // INICIALIZA√á√ÉO
        // ==========================================
        
        document.addEventListener('DOMContentLoaded', function() {
            carregarDados();
            document.getElementById('vendedorSelect').addEventListener('change', selectVendedor);
            
            // Verificar se j√° estava usando nuvem
            if (localStorage.getItem('usarNuvem') === 'true') {
                setTimeout(ativarNuvem, 1000);
            }
        });
    </script>
</body>
</html>